# Firebase App Hosting configuration
runConfig:
  # Use CI build script with TypeScript bypass
  buildCommand: npm run build:ci
  
  # Node.js runtime configuration
  runtime: nodejs20
  
  # Environment variables for the build
  env:
    - variable: NODE_ENV
      value: production
    - variable: NEXT_PUBLIC_DEPLOY_TARGET
      value: app-hosting
    - variable: NEXT_PUBLIC_STATIC_EXPORT
      value: "false"
    - variable: CI
      value: "true"
    - variable: IGNORE_TS_ERRORS
      value: "true"
    - variable: IGNORE_ESLINT_ERRORS
      value: "true"
  
  # Memory and CPU allocation for build
  cpu: 4
  memory: 8GiB
  
  # Timeout for build process (20 minutes)
  timeoutSeconds: 1200

# Server-side rendering configuration for Next.js App Router
serveConfig:
  # Use Node.js runtime for dynamic server rendering
  runtime: nodejs20
  
  # Start command for the Next.js standalone server
  startCommand: cd .next/standalone && node server.js
  
  # Port configuration
  port: 8080
  
  # Memory and CPU for production runtime
  memory: 2GiB
  cpu: 1
  
  # Health check endpoint
  healthCheck:
    path: /api/health
    
  # Environment variables for production
  env:
    - variable: NODE_ENV
      value: production
    - variable: PORT
      value: "8080"
    - variable: HOSTNAME
      value: "0.0.0.0"